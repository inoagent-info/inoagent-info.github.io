<!DOCTYPE html>
<html>
	<head>
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="application-name" content="–†–µ–µ—Å—Ç—Ä –∏–Ω–æ–∞–≥–µ–Ω—Ç–æ–≤">
		<meta name="apple-mobile-web-app-title" content="–†–µ–µ—Å—Ç—Ä –∏–Ω–æ–∞–≥–µ–Ω—Ç–æ–≤">
		<meta name="theme-color" content="#eeeeee">
		<meta name="msapplication-navbutton-color" content="#eeeeee">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<meta name="msapplication-starturl" content="/">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="icon" type="image/png" sizes="256x256" href="https://private-user-images.githubusercontent.com/176837028/352873932-9295ab95-9a94-4a0c-99b3-43637db96e92.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjIyMDY5NzEsIm5iZiI6MTcyMjIwNjY3MSwicGF0aCI6Ii8xNzY4MzcwMjgvMzUyODczOTMyLTkyOTVhYjk1LTlhOTQtNGEwYy05OWIzLTQzNjM3ZGI5NmU5Mi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNzI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDcyOFQyMjQ0MzFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05MjI3ZmE4YjcxNDc1OTRmZWY3MTAxZjU4YTk3YzVkYjhlYTkwN2NjNWI3OWNiNmFjOTNlNDI2ODZkNTRlN2RlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.2nL1Plm9fuZMxBIoBhu-PnsM4PI4AaqbuDJhV-kH9vI">
		<link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://private-user-images.githubusercontent.com/176837028/352873932-9295ab95-9a94-4a0c-99b3-43637db96e92.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjIyMDY5NzEsIm5iZiI6MTcyMjIwNjY3MSwicGF0aCI6Ii8xNzY4MzcwMjgvMzUyODczOTMyLTkyOTVhYjk1LTlhOTQtNGEwYy05OWIzLTQzNjM3ZGI5NmU5Mi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwNzI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDcyOFQyMjQ0MzFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05MjI3ZmE4YjcxNDc1OTRmZWY3MTAxZjU4YTk3YzVkYjhlYTkwN2NjNWI3OWNiNmFjOTNlNDI2ODZkNTRlN2RlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.2nL1Plm9fuZMxBIoBhu-PnsM4PI4AaqbuDJhV-kH9vI">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>C—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –†–µ–µ—Å—Ç—Ä –∏–Ω–æ–∞–≥–µ–Ω—Ç–æ–≤</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://albinodrought.github.io/chartjs-plugin-watermark/chartjs-plugin-watermark.js"></script>
	</head>
	<body>
		<nav class="navbar bg-body-tertiary noprint">
			<div class="container-fluid">
				<span class="navbar-brand mb-0 h1">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç ¬´–ò–Ω–æ–∞–≥–µ–Ω—Ç-–ò–Ω—Ñ–æ¬ª</span>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav">
						<li class="nav-item"><a class="nav-link" aria-current="page" href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
						<li class="nav-item"><a class="nav-link active" aria-current="page" href="stats.html">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç ¬´–ò–Ω–æ–∞–≥–µ–Ω—Ç-–ò–Ω—Ñ–æ¬ª</a></li>
						<li class="nav-item"><a class="nav-link" href="https://minjust.gov.ru/ru/activity/directions/998/">–†–µ–µ—Å—Ç—Ä –Ω–∞ —Å–∞–π—Ç–µ –ú–∏–Ω—é—Å—Ç–∞ –†–æ—Å—Å–∏–∏ (.pdf)</a></li>
						<li class="nav-item"><a class="nav-link" href="http://unro.minjust.ru/NKOReports.aspx?request_type=inag">–û—Ç—á—ë—Ç—ã –ù–ö–û –Ω–∞ —Å–∞–π—Ç–µ –ú–∏–Ω—é—Å—Ç–∞ –†–æ—Å—Å–∏–∏</a></li>
						<li class="nav-item"><a class="nav-link" href="https://github.com/inoagent-info">–ú—ã –Ω–∞ Github</a></li>
					</ul>
				</div>
			</div>
		</nav>
		<div style="margin-top: 20px;" class="wrapper d-flex flex-column min-vh-100">
			<div class="body flex-grow-1">
				<div class="container-lg px-4">
					<div class="row row-cols-1 row-cols-md-2">
						<div class="col">
							<div class="card mb-4">
								<div class="card-header"><span class="small ms-1">–ü–æ —Ç–∏–ø—É –∞–≥–µ–Ω—Ç–∞</span></div>
								<div class="card-body">
									<center>
										<div class="p-3">
											<canvas aria-label="–ü–æ —Ç–∏–ø—É –∞–≥–µ–Ω—Ç–∞" role="img" id="type"></canvas>
										</div>
									</center>
								</div>
							</div>
						</div>
						<div class="col">
							<div class="card mb-4">
								<div class="card-header"><span class="small ms-1">–ü–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é</span></div>
								<div class="card-body">
									<center>
										<div class="p-3">
											<canvas aria-label="–ö–æ–ª-–≤–æ –≤–∫–ª—é—á–µ–Ω–∏–π –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø–æ –≥–æ–¥–∞–º" role="img" id="law"></canvas>
										</div>
									</center>
								</div>
							</div>
						</div>
					</div>
					<div class="row row-cols-1 row-cols-md-2">
						<div class="col">
							<div class="card mb-4">
								<div class="card-header"><span class="small ms-1">–ö–æ–ª-–≤–æ –≤–∫–ª—é—á–µ–Ω–∏–π –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø–æ –≥–æ–¥–∞–º</span></div>
								<div class="card-body">
									<div class="p-3">
										<canvas aria-label="–ü–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é" role="img" id="years"></canvas>
										<div style="margin-top: 10px;">
											<center>
												<button disabled onClick='years_cfg.type = "bar"; years.update()' class="btn btn-primary">–î–∏–∞–≥—Ä–∞–º–º–∞</button>
												<button disabled onClick='years_cfg.type = "line"; years.update()'class="btn btn-primary">–ì—Ä–∞—Ñ–∏–∫</button>
											</center>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col">
							<div class="card mb-4">
								<div class="card-header"><span class="small ms-1">–ü—Ä–æ—á–µ–µ</span></div>
								<div class="card-body">
									<div class="p-3">
										<p>–°–∞–º—ã–π –º–æ–ª–æ–¥–æ–π –∏–Ω–æ–∞–≥–µ–Ω—Ç: <b><span id="youngest"></span></b></p>
										<p>–°–∞–º—ã–π –ø–æ–∂–∏–ª–æ–π –∏–Ω–æ–∞–≥–µ–Ω—Ç: <b><span id="oldest"></span></b></p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<footer class="noprint">
			<center>
				<br>
				<p>&copy; <a href="https://t.me/inoagentinfo">–ò–Ω–æ–∞–≥–µ–Ω—Ç-–ò–Ω—Ñ–æ</a> ü§çüíôü§ç</p>
				<br>
			</center>
		</footer>
		<script type="text/javascript">
			function generateYears(from) {
				let curr = new Date().getFullYear(), years = [];
				while ( from < curr ) {
					years.push((from++).toString());
				}
				years.push(`${curr} *`)
				return years;
			}
			function filter(body, prop, from) {
				let curr = new Date().getFullYear(), output = [];
				while ( from <= curr ) {
					output.push(body.filter(i => i[prop].includes(from.toString())).length);
					from++;
				}
				return output;
			}
			function filterLaw(body) {
				let laws = ["–°—Ç–∞—Ç—å—è 2.1", "–°—Ç–∞—Ç—å—è 6", "–°—Ç–∞—Ç—å—è 25.1", "–°—Ç–∞—Ç—å—è 29.1", "–°—Ç–∞—Ç—å—è 32", "–°—Ç–∞—Ç—å—è 7", "–°—Ç–∞—Ç—å—è 9"], output = [];
				for(let law of laws) {
					output.push(body.filter(i => i.law.includes(law)).length)
				}
				return output
			}

			fetch(`https://raw.githubusercontent.com/fz255/foreign-agents/main/registry.json`)
			.then(res => res.json())
			.then(body => {
				let ul = body.filter(i => i.inn.length==10).length
				let fl = body.filter(i => i.dob != "" || i.inn.length==12).length
				let type = new Chart(document.getElementById('type'), {
					type: 'pie',
					data: {
						labels: ['–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞', '–§–∏–∑–∏—á–µ—Å–∫–∏–µ –ª–∏—Ü–∞', '–ü—Ä–æ—á–µ–µ'],
						datasets: [{
							data: [ul, fl, body.length-(ul+fl)],
							backgroundColor: ['#ff5722', '#00e676', '#1e88e5'],
							borderWidth: 0.5 ,
							borderColor: '#ddd'
						}]
					},
					options: {
						plugins: { title: { display: true, text: '–ü–æ —Ç–∏–ø—É –∞–≥–µ–Ω—Ç–∞' }, subtitle: { display: true, text: `–í—Å–µ–≥–æ: ${body.length} –∑–∞–ø–∏—Å–µ–π` } },
						watermark: { image: "https://habrastorage.org/webt/a_/xt/c_/a_xtc_o6zp8oqpzkamwvuzlayfq.jpeg", x: 0, y: 0, width: 48, height: 48, opacity: 0.3 }
					}
				});
				let law = new Chart(document.getElementById("law"), {
					type: "pie",
					data: {
						labels: ['—Å—Ç. 2.1 272-–§–ó *', '—Å—Ç. 6 –ó–∞–∫–æ–Ω–∞ "–û –°–ú–ò"', '—Å—Ç. 25.1 –ó–∞–∫–æ–Ω–∞ "–û –°–ú–ò" *', 'c—Ç. 29.1 82-–§–ó *', '—Å—Ç. 32 7-–§–ó', '—Å—Ç. 7 255-–§–ó', '—Å—Ç. 9 255-–§–ó'],
						datasets: [{
							data: filterLaw(body),
							backgroundColor: ['#4dc9f6', '#f67019',  '#f53794', '#acc236', '#00a950', '#58595b', '#8549ba'],
							borderWidth: 0.5 ,
							borderColor: '#ddd'
						}]
					},
					options: {
						plugins: { title: { display: true, text: '–ü–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—é' }, subtitle: { display: true, text: `* - —Å—Ç–∞—Ç—å—è —É—Ç—Ä–∞—Ç–∏–ª–∞ —Å–∏–ª—É` } },
						watermark: { image: "https://habrastorage.org/webt/a_/xt/c_/a_xtc_o6zp8oqpzkamwvuzlayfq.jpeg", x: 0, y: 0, width: 48, height: 48, opacity: 0.3 }
					}
				})
				let years_cfg = {
					type: "bar",
					data: {
						labels: generateYears(2013),
						datasets: [
							{ label: '–í–Ω–µ—Å–µ–Ω–æ', backgroundColor: "#1e88e5", borderColor: "#1e88e5", data: filter(body, "dateIn", 2013), pointStyle: 'circle', pointRadius: 5, pointHoverRadius: 10 },
							{ label: '–ò—Å–∫–ª—é—á–µ–Ω–æ', backgroundColor: "#ff5722", borderColor: "#ff5722", data: filter(body, "dateOut", 2013), pointStyle: 'circle', pointRadius: 5, pointHoverRadius: 10 }
						]
					},
					options: {
						plugins: { title: { display: true, text: '–ü–æ –∫–æ–ª-–≤—É –≤–Ω–µ—Å–µ–Ω–∏–π/–∏—Å–∫–ª—é—á–µ–Ω–∏–π' }, subtitle: { display: true, text: '* - –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è' }
						},
						watermark: { image: "https://habrastorage.org/webt/a_/xt/c_/a_xtc_o6zp8oqpzkamwvuzlayfq.jpeg", x: 0, y: 0, width: 48, height: 48, opacity: 0.3 }
					}
				}
				let years = new Chart(document.getElementById('years'), years_cfg)
				window.years_cfg = years_cfg
				window.years = years
				document.querySelectorAll("button.btn-primary")[0].removeAttribute("disabled")
				document.querySelectorAll("button.btn-primary")[1].removeAttribute("disabled")

				let fls = body.filter(i => i.dob != "").map(i => { return { fullName: i.fullName, dob: i.dob, id: i.id } })
				let youngest = fls.reduce((prev, current) => {
					const prevDate = new Date(prev.dob.split('.').reverse().join('-'));
					const currentDate = new Date(current.dob.split('.').reverse().join('-'));

					return currentDate < prevDate ? prev : current;
				})
				let oldest = fls.reduce((prev, current) => {
					const prevDate = new Date(prev.dob.split('.').reverse().join('-'));
					const currentDate = new Date(current.dob.split('.').reverse().join('-'));

					return currentDate > prevDate ? prev : current;
				})
				document.getElementById("youngest").textContent = `${youngest.fullName} (–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${youngest.dob}, –∑–∞–ø–∏—Å—å ‚Ññ ${youngest.id})`
				document.getElementById("oldest").textContent = `${oldest.fullName} (–¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${oldest.dob}, –∑–∞–ø–∏—Å—å ‚Ññ ${oldest.id})`
			})
		</script>
	</body>
</html>
